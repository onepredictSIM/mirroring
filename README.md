# Proserve Repository Template

## TODO

## 프로젝트 세팅

```shell
make setup
```

- 수행하는 항목
    - 라이브러리 설치
    - git commit message 템플릿 적용
    - pre-commit 설치

## 개발 방법론

- XP(Extreme Programming)를 많이 참조하였습니다.
  - [위키피디아](https://ko.wikipedia.org/wiki/%EC%9D%B5%EC%8A%A4%ED%8A%B8%EB%A6%BC_%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D)
  - [관련 글](http://blog.skby.net/xp-extreme-programming/)
  - XP의 가치/원칙/실천사항은 읽어보시길 바랍니다.

### 코드 일관성을 위한 도구

- Format: black, isort
- Lint: flake8(+plugins)
- Typehint: mypy
- Test: pytest(+coverages)
- CI: pre-commit, github action

### Pair Programming

- Pair Programming의 장점
  - 함께 고민한 결과 >>> 혼자 고민한 결과
  - 실시간으로 코드 리뷰가 이루어져서 코드 일관성 향상
  - 프로젝트 전체에 대한 이해도 향상
  - 새롭게 접한 프레임워크/도구에 대한 빠른 적응
- 15분 주기로 driver(코드 작성)와 navigator(훈수)를 번갈아가면서 진행합니다.
- 한 명이 키보드를 독점하여 한 명은 구경만 하는 것이 아니라면 방법은 편한대로 바꾸셔도 좋습니다.
- 구현 시작 전에 개발하고자 하는 기능에 대한 충분한 논의를 거치고 작업하는 것을 추천드립니다.

### TDD

1. 실패하는 작은 단위 테스트를 작성합니다.
2. 테스트를 통과하기 위한 코드를 작성합니다. 이를 위해 정답이 아닌 가짜 구현 등을 작성할 수도 있습니다.
3. 다음의 테스트 코드를 작성합니다. 실패 테스트가 없을 경우에만 성공 테스트를 작성합니다.
4. 새로운 테스트를 통과하기 위해 코드를 추가 또는 수정합니다.
5. 1~4단계를 반복하여 실패/성공의 모든 테스트 케이스를 작성합니다.
6. 개발된 코드들에 대해 모든 중복을 제거하며 리팩토링합니다.

- Pair Programming을 한 명은 테스트를 작성하고, 한 명은 테스트를 통과하는 코드를 짜는 것으로 구성해도 좋습니다.

### 통합 테스트

- 통합 테스트
  - API 서버를 실행시키고 테스트 요청에 대한 올바른 응답을 하는지 테스트합니다.
  - master 노드에 merge를 위한 PR 작성 시에 수행합니다.

### 형상 관리

- `github flow` 전략으로 브랜치를 관리

> github flow
>
> 1. master 브랜치는 어떤 때든 배포가 가능해야 합니다.
>
> - master 브랜치는 항상 최신 상태며, stable 상태로 product에 배포되는 브랜치
> - 이 브랜치에 대해서는 엄격한 role과 함께 사용합니다.
> - merge하기 전에 충분히 테스트를 해야합니다. 테스트는 로컬에서 하는 것이 아니라 브랜치를 push 하고 Jenkins로 테스트 합니다.
>
> 2. master에서 새로운일을 시작하기 위해 브랜치를 만든다면, 이름을 명확히 작성합니다.
>
> - 브랜치는 항상 master 브랜치에서 만듭니다.
> - Git-flow와는 다르게 feature 브랜치나 develop 브랜치가 존재하지 않습니다.
> - 새로운 기능을 추가하거나, 버그를 해결하기 위한 브랜치 이름은 자세하게 어떤 일을 하고 있는지에 대해서 작성해주도록 합니다.
> - 커밋메시지를 명확하게 작성합니다.
>
> 3. 원격지 브랜치로 수시로 push 합니다.
>
> - Git-flow와 상반되는 방식
> - 항상 원격지에 자신이 하고 있는 일들을 올려 다른 사람들도 확인할 수 있도록 해줍니다.
> - 이는 하드웨어에 문제가 발생해 작업하던 부분이 없어지더라도, 원격지에 있는 소스를 받아서 작업할 수 있도록 해줍니다.
>
> 4. 피드백이나 도움이 필요할 때, 그리고 merge 준비가 완료되었을 때는 pull request를 생성합니다.
>
> - pull request는 코드 리뷰를 도와주는 시스템
> - 이것을 이용해 자신의 코드를 공유하고, 리뷰 받습니다.
> - merge 준비가 완료되었다면 master 브랜치로 반영을 요구합니다.
>
> 5. 기능에 대한 리뷰와 논의가 끝난 후 master로 merge합니다.
>
> - 곧장 product로 반영이 될 기능이므로, 이해관계가 연결된 사람들과 충분한 논의 이후 반영하도록 합니다.
> - 물론 CI도 통과해야합니다!
>
> 6. master로 merge되고 push 되었을 때는, 즉시 배포되어야합니다.
>
> - GitHub-flow의 핵심
> - master로 merge가 일어나면 자동으로 배포가 되도록 설정해놓습니다.

- 2번의 커밋 메시지 관련해서는 `git commit -m` 대신 `git commit`을 이용하여 메시지 템플릿을 사용합니다.
- 3번의 원격지 브랜치로 수시로 push하는 경우 `pre-commit`을 통과하지 못할 수 있습니다.
  - 이러한 경우에는 `git commit -n`을 통해 우회하여 커밋할 수 있습니다.
  - 하지만, 되도록 하나의 기능을 세부 기능으로 쪼개어 개발하여 commit마다 완결성을 갖게 하는 것을 추천합니다.
- 4번의 PR 관련해서는 통합 테스트를 수행한 후 결과를 PR에 작성하여 최소 한 명의 리뷰를 받고 merge 합니다.
- 본 제품은 on-prem 버전이므로 자동 배포가 어려울 수 있으므로 6번을 제외한 나머지를 지키는 것으로 합시다.
- 원격 배포가 가능하게 되는 경우 동시에 여러 대에 반영할 수 있는 방법을 모색해야 합니다.
  - 고려해볼만한 도구: `chef`, `puppet`, `ansible`, `saltstack`, `Fabric`, `Mussh`, `SSH Power Tool`, `dsh` `PuSSH`, `pconsole`, `ClusterSSH`, ...
  - 해당 방법이 가능해지면 간단한 리서치 후 균태님과 논의하는 자리를 가지면 될 것 같습니다.

### BDD / E2E 테스트 / 인수 테스트

- [BDD 관련 글](https://mingule.tistory.com/43)
- 프로젝트 요구사항을 바탕으로 BDD 테스트 케이스를 작성한 뒤 수행합니다.
- E2E 테스트: API와 화면 연동까지 완료되었을 때, 고객의 시나리오 대로 잘 작동하는지를 테스트합니다.
- 인수 테스트: 과제 검수 과정으로 대체 될 것 같습니다.

### 스프린트

- 위의 과정은 2주 간격으로 반복적으로 진행될 예정입니다.
  - 고객과의 정기 미팅을 2주마다 진행하면서 요구사항을 구체화하고 고객이 예상한 기능대로 구현되었는지를 확인하면 더욱 좋을 것 같습니다.
  - 정기 미팅 이 후 스프린트 회고와 다음 스프린트에서 구현할 내용을 정하는 계획을 세웁니다.
- 또한 스프린트 내에서 매일 진행사항을 공유하는 stand-up 미팅을 가질 예정입니다.
